{
    "name": "dev",
    "dockerFile": "docker/Dockerfile",
    // ---------- GPU (NVIDIA by default, remove for non-GPU hosts) ----------
    "runArgs": [
        "--gpus",
        "all",
        "--runtime=nvidia",
        "--shm-size=2g",
        "-e",
        "NVIDIA_DRIVER_CAPABILITIES=all",
        "--security-opt",
        "seccomp=unconfined"
    ],
    "remoteUser": "dev",
    // ---------- Desktop GUI via desktop-lite (noVNC) ----------
    "features": {
        "ghcr.io/devcontainers/features/desktop-lite:1": {}
    },
    // Port 6080 for noVNC desktop access
    "forwardPorts": [
        6080
    ],
    "portsAttributes": {
        "6080": {
            "label": "Desktop GUI",
            "onAutoForward": "openBrowser"
        }
    },
    // ---------- VS Code Customizations ----------
    "customizations": {
        "vscode": {
            "settings": {
                "git.ignoreMissingGitWarning": true
            }
        }
    },
    "shutdownAction": "stopContainer",
    "containerEnv": {
        "DONT_PROMPT_WSL_INSTALL": "1"
    },
    // Post-create: fix permissions on workspace
    "postCreateCommand": "${containerWorkspaceFolder}/.devcontainer/cmd/setup-env"
}
